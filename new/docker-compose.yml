services:
  web:
    build: ./nginx
    container_name: pong-nginx
    ports:
      - "8443:443"
    volumes:
      - ./app/html:/var/www/html
      - ./data:/data
    depends_on:
      - game-server
    networks:
      - pong-network
    restart: unless-stopped

  game-server:
    build: ./game-server
    container_name: pong-game-server
    environment:
      - API_PORT=3000
      - DATABASE_URL=/data/users.db
      - COOKIE_SECRET=devsecret_change_me
      - GAME_SERVER_SECRET=devsecret
    volumes:
      - ./data:/data
    networks:
      - pong-network
    restart: unless-stopped

networks:
  pong-network:
    driver: bridge
